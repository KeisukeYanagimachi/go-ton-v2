# 11_ux_spec.md

## ChangeLog

- 2026-01-11: Candidate / Staff のUX方針を明文化
- 2026-01-11: UX観点（前提状態/役割/期待感情）を追加
- 2026-01-11: 問題管理・問題作成のUX要件を明文化
- 2026-01-11: 試験結果（Staff）のUX要件を明文化
- 2026-01-11: 監査ログ（Staff）のUX要件を明文化
- 2026-01-11: 試験結果の受験者名検索を明文化

---

## 1. 目的と適用範囲

本書は、社内SPIアプリの UX を明確化し、画面操作の迷いと誤操作を最小化するための基準を定義する。

対象:

- Candidate（受験者）のログイン〜試験完了まで
- Staff（運営者）のログイン〜試験定義・運用操作まで

---

## 2. 共通UX原則

1. 画面内の主目的が一目で分かる構成にする
2. 操作は「全体 → 詳細」へ絞り込める流れを前提とする
3. エラー/成功メッセージは該当操作に近接して表示する
4. 同じ意味の操作は同じ導線・文言で統一する
5. 既存データの上書きではなく、履歴が追える設計を優先する

---

## 3. Staff UX

### 3.1 ログイン（dev環境）

#### 前提状態

- 何をしたいか: 運用作業に入るためにログインしたい
- 何を知らないか: どのメールが許可されているか
- 不安: 入力ミスでログインできない

#### 役割

- 入力（メール）

#### 期待する感情

- 迷わず進める
- 安心する

#### UI要件

- dev環境はメール入力のみでログインする
- 成功後は Staff ホームへ遷移する
- 失敗時はフォーム直下にエラーを表示する

### 3.2 試験定義（Exam / ExamVersion）

#### 前提状態

- 何をしたいか: 試験を選んで定義を確認・更新したい
- 何を知らないか: どの試験が対象か、最新バージョンがどれか
- 不安: 誤って既存の定義を壊すのではないか

#### 役割

- 決断（対象試験の選択）
- 確認（バージョン構成の把握）
- 入力（新規/バージョン追加）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 試験一覧と編集を分離し、「何を選ぶか」と「何を操作するか」を明確にする
- 左カラムに試験一覧（検索付き）
  - 試験名・IDで検索可能
  - 1つだけ選択状態になる
- 右カラムに試験詳細
  - 最新バージョンを最上段に表示
  - 過去バージョンはトグルで表示/非表示
- 「編集」は既存バージョンの上書きではなく、**新しいバージョン追加**として扱う
  - 既存試験の更新は「バージョン追加」という動線に統一
  - 最新バージョン番号+1を初期値として提示

### 3.3 新規作成とバージョン追加の動線

#### 前提状態

- 何をしたいか: 新規試験を作るか、既存試験を更新したい
- 何を知らないか: どちらの操作が適切か
- 不安: 誤った動線で意図しない作成になる

#### 役割

- 決断（新規作成/既存更新の選択）
- 入力（各フォーム）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 「新規試験の作成」と「既存試験のバージョン追加」を別のブロックで表示
- ラベルと補足文で用途の違いを明確化する

### 3.4 出題割当（ExamVersionQuestions）

#### 前提状態

- 何をしたいか: 試験バージョンに問題を割り当てたい
- 何を知らないか: どのモジュールに何が割り当て済みか
- 不安: DRAFT以外を触ってしまう、誤った問題を割り当てる

#### 役割

- 入力（対象バージョン/モジュール/問題）
- 確認（割当一覧）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 操作対象は DRAFT のみ
- 出題割当の入力は「対象バージョン → モジュール → 問題」の順で選択
- 問題は検索可能、選択中の問題をプレビュー表示
- 割当一覧はモジュール単位でグルーピングし、件数を明示
- エラー/成功メッセージは出題割当セクション内に表示
- 問題が未登録の場合は「問題が登録されていません」と明示し選択を無効化
- 未分類（モジュール未設定）の問題は出題割当の候補に表示しない

### 3.5 問題管理

#### 前提状態

- 何をしたいか: 問題を検索・選択し、詳細を確認/編集したい
- 何を知らないか: どのモジュールに属するか、最新の内容か
- 不安: どの問題を編集しているか分からなくなる

#### 役割

- 決断（対象問題の選択）
- 入力（問題文、選択肢、正解、モジュール）
- 確認（状態や内容の整合）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 一覧（左）と詳細（右）を分離し、選択中の問題が明確に分かる構成
- 検索は「キーワード/ID」で実行できる
- モジュールで絞り込みできる
- 選択中の問題は詳細パネルで編集できる
- 編集保存の結果（成功/失敗）は対象フォームの近くに表示する

### 3.6 問題作成

#### 前提状態

- 何をしたいか: 新しい問題を追加したい
- 何を知らないか: 正解の設定方法、必須項目
- 不安: 必須項目を満たしていないまま保存してしまう

#### 役割

- 入力（問題文、選択肢、正解、モジュール）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 問題作成時に必ずモジュールを選択させる
- 未分類の問題は保存できない
- 選択肢は「単一選択が成立する最小構成」を満たすことを必須とする
  - 理由: 選択式として成立する最小条件（2択以上）を欠くと業務上の問題になるため
- 正解は必ず1つだけ選択させる
  - 理由: 「単一選択」要件をUI段階で明示し、誤入力を防ぐため
- 詳細から「新規作成」へ切り替えられる導線を用意する

### 3.7 試験結果の閲覧

#### 前提状態

- 何をしたいか: 試験結果を確認したい
- 何を知らないか: 対象 Attempt がどれか、採点済みか
- 不安: 誤って別の Attempt を確認してしまう

#### 役割

- 決断（対象 Attempt の選択）
- 確認（スコア/状態/内訳の把握）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 一覧と詳細を分離し、対象 Attempt が明確に分かる構成
- 一覧は ticket_code / Candidate 氏名 / status で絞り込みできる
- 一覧には採点済みかが分かる情報を明示する
- 詳細は総合スコアとモジュール別スコアを同一画面で確認できる

### 3.8 監査ログの閲覧

#### 前提状態

- 何をしたいか: 運用上の重要操作が実行されたか確認したい
- 何を知らないか: いつ・誰が・何を実行したか
- 不安: 目的のログがすぐに見つからない

#### 役割

- 確認（監査ログの内容把握）
- 決断（追加調査の必要性判断）

#### 期待する感情

- 迷わず進める
- ちゃんと理解できたと思える

#### UI要件

- 一覧のみで主要情報が確認できる
- action と期間で絞り込みできる
- 最新順で表示される
- metadata_json は一覧に表示せず、必要に応じて別途確認する
- 表示件数が上限（200件）に達する場合は上限が分かる表示にする

---

## 4. Candidate UX

### 4.1 ログイン

#### 前提状態

- 何をしたいか: 試験を開始するためにログインしたい
- 何を知らないか: 受験票コードの場所、PINの形式
- 不安: 入力ミスで開始できない、試験開始が早すぎる

#### 役割

- 入力（受験票コード + PIN）

#### 期待する感情

- 迷わず進める
- 安心する

#### UI要件

- 受験票コード + PIN（生年月日）を入力する
- 成功後は「試験開始」画面へ遷移する
- 失敗時はフォーム直下にエラーを表示する

### 4.2 試験開始

#### 前提状態

- 何をしたいか: 試験を始めたい
- 何を知らないか: 開始後の制限や戻れないこと
- 不安: いきなり開始してしまう

#### 役割

- 決断（開始の意思確認）

#### 期待する感情

- 迷わず進める
- 急かされない

#### UI要件

- ログイン後、試験開始ボタンを明示的に表示
- 開始は受験者の明示操作で進む

### 4.3 試験画面

#### 前提状態

- 何をしたいか: 問題に回答し試験を完了したい
- 何を知らないか: 残り時間、進行ルール、保存状態
- 不安: 回答が保存されていない/間違えて移動する

#### 役割

- 入力（回答）
- 確認（残り時間/保存状態）

#### 期待する感情

- 迷わず進める
- 急かされない
- ちゃんと理解できたと思える

#### UI要件

- 画面スクロールを最小化し、設問と回答領域に集中できる構成
- 未回答のまま次へ進めない
- 保存/結果通知は明示的に表示し、操作対象との関連が分かる位置に出す

---

## 5. 表示とメッセージの原則

- 入力系のエラーは対象項目の近くに表示する
- 成功/完了メッセージは対象操作の直後に表示する
- 画面上部の汎用通知は、ページ全体に関わる内容のみを扱う
